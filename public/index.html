<!DOCTYPE html>
<html lang="ko"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<title>원클릭 원고 자동생성기 (연동 완료)</title>
<style>:root{--bg:#f7fbff;--card:#ffffff;--ink:#0f172a;--ink2:#475569;--pri:#2563eb;--mut:#94a3b8;--bd:#e2e8f0;--red:#dc2626}
*{box-sizing:border-box} body{margin:0;background:var(--bg);color:var(--ink);font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,"Apple SD Gothic Neo","Malgun Gothic",sans-serif}
.wrap{max-width:980px;margin:26px auto;padding:0 16px} h1{font-size:22px;margin:0 0 14px}
.card{background:var(--card);border:1px solid var(--bd);border-radius:14px;box-shadow:0 2px 8px rgba(2,6,23,.05);padding:16px}
.row{display:grid;grid-template-columns:1fr 1fr;gap:12px}@media (max-width:780px){.row{grid-template-columns:1fr}}
label{font-size:13px;color:var(--ink2);display:block;margin:8px 0 6px}
select,input,textarea,button{width:100%;padding:12px;border-radius:10px;border:1px solid var(--bd);font-size:15px;background:#fff;color:var(--ink)}
textarea{min-height:160px;resize:vertical;line-height:1.7}
.btn{cursor:pointer;border:1px solid var(--pri);background:var(--pri);color:#fff;font-weight:600}
.btn.ghost{background:#fff;color:var(--pri)} .btn.small{padding:8px 10px;font-size:13px;border-radius:8px}
.actions{display:flex;gap:10px;flex-wrap:wrap;margin-top:10px} .note{font-size:12px;color:var(--ink2)} .toast{margin-top:8px;font-size:13px;color:#0f172a}
.out{min-height:240px;white-space:pre-wrap;word-break:keep-all} .copybar{display:flex;justify-content:space-between;align-items:center;margin:8px 0}
.mut{color:var(--mut)} .foot{font-size:13px;margin:18px 6px 30px;color:#0f172a;text-align:center} .foot .maker{font-size:14px;font-weight:700} .foot .ban{color:var(--red);font-size:12px;margin-top:4px}
</style></head>
<body><div class="wrap">
<h1>원고 자동생성기 <span style="padding:2px 8px;border-radius:999px;background:#eef2ff;color:#3730a3;font-size:12px;margin-left:8px;display:inline-block">연동 완료</span></h1>
<div class="card">
  <div class="row">
    <div><label>원고 종류</label><select id="mode"><option value="review">후기성(리뷰)</option><option value="info">정보성</option></select></div>
    <div><label>글자수 (공백 제외)</label><select id="len"><option value="100-300">100 ~ 300자</option><option value="300-500">300 ~ 500자</option><option value="600-800">600 ~ 800자</option><option value="800-1000">800 ~ 1000자</option><option value="1000-2000">1000 ~ 2000자</option></select></div>
  </div>
  <div class="row">
    <div><label>업체명</label><input id="company" placeholder="예: 아이디헤어 반포1호점"></div>
    <div><label>페르소나 변주(선택)</label><input id="persona" placeholder="예: 친구와 주말 방문, 점심 혼밥, 비 오는 날 등"></div>
  </div>
  <div><label><input type="checkbox" id="hideName"> (정보성) 업체명 언급 금지</label></div>
  <div><label>가이드(자유 형식)</label><textarea id="guide" placeholder="가이드를 붙여넣어 주세요. 메뉴/서비스/분위기/특징 등 자유롭게 적어도 됩니다."></textarea></div>
  <div class="actions"><button class="btn" id="gen">원고 생성</button><button class="btn ghost" id="reset">가이드 초기화</button></div>
  <div id="toast" class="toast mut"></div>
</div>
<div class="card" style="margin-top:14px">
  <div class="copybar"><div><strong>생성된 원고</strong> <span id="count" class="mut">0자(공백 제외)</span></div><button class="btn small ghost" id="copyOut">복사</button></div>
  <div id="out" class="out"></div>
</div>
<div class="card" style="margin-top:14px">
  <div class="copybar"><div><strong>금지어 검사 결과</strong></div><button class="btn small ghost" id="copyBan">복사</button></div>
  <div class="note">금지어는 단어 내부에 포함돼도 금지어 부분만 <code>*금지어</code>로 표기합니다.</div>
  <div id="ban" class="out"></div>
</div>
<div class="foot"><div class="maker">제작자 : 드림투유 은경</div><div class="ban">무단 배포&공유 금지</div></div>
</div>
<script>
(function(){'use strict'; const $=id=>document.getElementById(id);
const clean=t=>String(t||'').replace(/\\u00A0/g,' ').replace(/[ \\t]{2,}/g,' ').replace(/\\s+\\n/g,'\\n').trim();
const noSpaceLen=s=>String(s||'').replace(/\\s/g,'').length;
function smartWrap(text,width=20){const sep=/[,，]|·/; const end=/[.?!]/; const words=String(text).replace(/\\s+/g,' ').trim().split(' '); const lines=[]; let line=''; const push=()=>{if(line){lines.push(line);line='';}}; for(const w of words){const join=(line?line+' ':'')+w; const len=join.replace(/\\s/g,'').length; if(len<=width){line=join; if(sep.test(w.slice(-1))||end.test(w.slice(-1))) push();} else{push(); if(w.replace(/\\s/g,'').length>width){let buf=w; while(buf.replace(/\\s/g,'').length>width){lines.push(buf.slice(0,width)); buf=buf.slice(width);} line=buf; if(sep.test(line.slice(-1))||end.test(line.slice(-1))) push();} else{line=w; if(sep.test(w.slice(-1))||end.test(w.slice(-1))) push();}}} push(); return lines.join('\\n');}
const BAN=['다녀','방문','추천','경험','보건','복지','전문','최신','첨단','최소','최고','최상','확실','안전','만족','보장','무료','할인','혜택','특가','수험생','효능','효과','맞춤','완치'];
function markBan(text){let out=String(text||''); BAN.forEach(w=>{try{out=out.replace(new RegExp(w,'g'),'*'+w)}catch(e){}}); return out;}
async function generate(){const mode=$('mode').value; const len=$('len').value; const company=clean($('company').value); const guide=clean($('guide').value); const persona=clean($('persona').value); const hide=$('hideName').checked; $('toast').textContent='원고 생성까지 최대 1~2분 소요 될 수 있습니다.'; $('out').textContent=''; $('ban').textContent=''; $('count').textContent='0자(공백 제외)';
  const payload={mode,length:len,company,guide,persona_seed:persona,hide_name:hide};
  try{const res=await fetch('/generate',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(payload)});
    const ct=res.headers.get('content-type')||''; const data=ct.includes('application/json')?await res.json():await res.text(); if(!res.ok){const msg=(data&&data.error)?data.error:('HTTP '+res.status); throw new Error(msg);}
    let txt=''; if(typeof data==='string'){txt=data} else if(typeof data?.text==='string'){txt=data.text} else if(typeof data?.output==='string'){txt=data.output} else if(typeof data?.result==='string'){txt=data.result} else{const cand=['content','message','data','body']; for(const k of cand){ if(typeof data[k]==='string'){txt=data[k]; break;} } if(!txt) txt=JSON.stringify(data);}
    const wrapped=smartWrap(txt,20); $('out').textContent=wrapped; $('count').textContent=noSpaceLen(txt)+'자(공백 제외)'; $('ban').textContent=markBan(wrapped); $('toast').textContent='완료!';
  }catch(e){$('toast').textContent='오류: '+e.message;}}
async function copyEl(id){const t=$(id).textContent; try{await navigator.clipboard.writeText(t); alert('복사되었습니다.');}catch(e){const ta=document.createElement('textarea'); ta.value=t; document.body.appendChild(ta); ta.select(); document.execCommand('copy'); document.body.removeChild(ta); alert('복사되었습니다.');}}
document.addEventListener('DOMContentLoaded',()=>{document.getElementById('gen').addEventListener('click',generate); document.getElementById('reset').addEventListener('click',()=>{$('guide').value='';$('toast').textContent='';}); document.getElementById('copyOut').addEventListener('click',()=>copyEl('out')); document.getElementById('copyBan').addEventListener('click',()=>copyEl('ban'));});
})();</script>
</body></html>
